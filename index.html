<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Learning Assistant (Debug)</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6f9; padding:20px; }
    h1 { text-align: center; }
    .container { max-width: 800px; margin:auto; background:white; padding:20px; border-radius:10px; }
    textarea { width:100%; padding:10px; margin-bottom:10px; }
    button { padding:10px 15px; margin-right:5px; cursor:pointer; }
    .result { margin-top:15px; padding:10px; background:#f9f9f9; border-left:4px solid #007bff; }
    .dual { display:flex; gap:10px; flex-wrap:wrap; }
    .dual .result { flex:1; min-width:300px; }
  </style>
</head>
<body>
  <h1>AI Learning Assistant ðŸ“š (Debug Mode)</h1>
  <div class="container">
    <textarea id="question" rows="4" placeholder="Tulis pertanyaanmu..."></textarea>
    <br>
    <button onclick="askAI('gpt')">Tanya GPT</button>
    <button onclick="askAI('gemini')">Tanya Gemini</button>
    <button onclick="askAI('both')">Bandingkan Keduanya</button>
    <div id="answers"></div>
  </div>

  <script>
    const GPT_API_KEY = "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";       // ganti di backend!
    const GEMINI_API_KEY = "AIzaSyAg1ahiWIFCutnF24YAyxgT_-mRvPM4fMA"; // ganti di backend!

    async function askAI(model) {
      const question = document.getElementById("question").value.trim();
      if (!question) return alert("Tulis dulu pertanyaannya!");

      document.getElementById("answers").innerHTML = "<p>Loading...</p>";

      if (model === "gpt") {
        const gpt = await fetchGPT(question);
        document.getElementById("answers").innerHTML =
          `<div class='result'><b>GPT:</b><br>${gpt}</div>`;
      }
      else if (model === "gemini") {
        const gemini = await fetchGemini(question);
        document.getElementById("answers").innerHTML =
          `<div class='result'><b>Gemini:</b><br>${gemini}</div>`;
      }
      else if (model === "both") {
        const [gpt, gemini] = await Promise.all([
          fetchGPT(question), fetchGemini(question)
        ]);
        document.getElementById("answers").innerHTML = `
          <div class="dual">
            <div class="result"><b>GPT:</b><br>${gpt}</div>
            <div class="result"><b>Gemini:</b><br>${gemini}</div>
          </div>
        `;
      }
    }

    async function fetchGPT(prompt) {
      try {
        const res = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${GPT_API_KEY}`
          },
          body: JSON.stringify({
            model: "gpt-4o-mini", // kalau error coba ganti "gpt-3.5-turbo"
            messages: [{ role: "user", content: prompt }]
          })
        });

        const data = await res.json();
        console.log("GPT raw response:", data); // DEBUG

        if (!res.ok) {
          return `Error GPT (${res.status}): ${JSON.stringify(data)}`;
        }

        return data.choices?.[0]?.message?.content || "Tidak ada jawaban dari GPT.";
      } catch (e) {
        console.error("GPT error:", e); // DEBUG
        return "Error GPT: " + e.message;
      }
    }

    async function fetchGemini(prompt) {
      try {
        const res = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
          }
        );

        const data = await res.json();
        console.log("Gemini raw response:", data); // DEBUG

        if (!res.ok) {
          return `Error Gemini (${res.status}): ${JSON.stringify(data)}`;
        }

        return data.candidates?.[0]?.content?.parts?.[0]?.text || "Tidak ada jawaban dari Gemini.";
      } catch (e) {
        console.error("Gemini error:", e); // DEBUG
        return "Error Gemini: " + e.message;
      }
    }
  </script>
</body>
</html>
